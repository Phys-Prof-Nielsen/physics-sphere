

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>A2.1 Numerical Integration: Finite Difference Methods &#8212; A Competency Approach to Introductory Physics</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Module-A2/Numerical-methods';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="A1.x Problems" href="../Module-A1/problemsA1.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/college-physics-A.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/college-physics-A.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    A Competency Approach to Introductory Physics: A Compendium to the A Exam
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Module A1 - Advanced Dynamics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Module-A1/Polar-coordinates.html">A1.1 Kinematics in Polar Coordinates</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Module-A1/Uniform-circular-motion.html">A1.2 Newton’s 2nd Law: Uniform Circular Motion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Module-A1/problemsA1.html">A1.x Problems</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Module A2 - Numerical Method</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">A2.1 Numerical Integration: Finite Difference Methods</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FModule-A2/Numerical-methods.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/Module-A2/Numerical-methods.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>A2.1 Numerical Integration: Finite Difference Methods</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a2-1-1-motivation">A2.1.1 Motivation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a2-1-2-linearization">A2.1.2 Linearization</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a2-1-3-first-order-forward-finite-difference-method">A2.1.3 First Order Forward Finite Difference Method</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="a2-1-numerical-integration-finite-difference-methods">
<h1>A2.1 Numerical Integration: Finite Difference Methods<a class="headerlink" href="#a2-1-numerical-integration-finite-difference-methods" title="Permalink to this headline">#</a></h1>
<hr style="height:2px;border-width:0;color:gray;background-color:gray"><section id="a2-1-1-motivation">
<h2>A2.1.1 Motivation<a class="headerlink" href="#a2-1-1-motivation" title="Permalink to this headline">#</a></h2>
<p>We have seen that many of examples encountered in this course
come with assumptions that makes them less applicable to everyday life.
While these examples are great at illustrating important concepts, they fail
in providing accurate prediction for real-life example. When these
assumptions are not valid, our problems often become too difficult to obtain
exact solutions for, and our best effort is to provide approximate solutions
that are correct to within a set acceptable error margin.</p>
<p>As an example, Newton’s second law is a second order differential equation, which in many real-life applications is non-linear and only solveable through numerical methods. Under certain situations, we can transform it into coupled first order differential equations that can be solved by numerical integration methods. The objective of this note is to obtain these numerical integration schemes known as <strong>finite difference methods</strong>.</p>
<hr style="height:2px;border-width:0;color:gray;background-color:gray"></section>
<section id="a2-1-2-linearization">
<h2>A2.1.2 Linearization<a class="headerlink" href="#a2-1-2-linearization" title="Permalink to this headline">#</a></h2>
<p>Let us consider the graphical setup below. Assume that we have
knowledge of a data point with
coordinates <span class="math notranslate nohighlight">\([x_0,f(x_0)]\)</span> of a function
<span class="math notranslate nohighlight">\(f(x)\)</span>, and we desire knowledge about
a point P with coordinates <span class="math notranslate nohighlight">\([x, f(x)]\)</span> in
close proximity to the data point.</p>
<img src="A2-fig1.png" width="400">
<p>In the Figure, the blue line represents the function <span class="math notranslate nohighlight">\(f(x)\)</span> and the red line is the tangent line at point <span class="math notranslate nohighlight">\([x_0,f(x_0)]\)</span>, which is the best linear
representation of the function at that point. The tangent line is represented
by the linear equation:</p>
<div class="alert alert-success">
<div class="math notranslate nohighlight">
\[ L(x) = f(x_0) + A|_{x = x_0}(x - x_0) \tag{1}\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(A\)</span> is the <strong>instantaneous</strong> slope at point <span class="math notranslate nohighlight">\(x_0\)</span></p>
<p>If we use this equation to approximate the function <span class="math notranslate nohighlight">\(f(x)\)</span> at point P, we call <span class="math notranslate nohighlight">\(L(x)\)</span> <strong>the
linearization</strong> or the linear approximation of <span class="math notranslate nohighlight">\(f(x)\)</span>. From the figure, we can see
that our guess <span class="math notranslate nohighlight">\(L(x)\)</span> for <span class="math notranslate nohighlight">\(f(x)\)</span> at point P is only an approximation and we introduce an
error with this approximation.</p>
<hr style="height:2px;border-width:0;color:gray;background-color:gray"></section>
<section id="a2-1-3-first-order-forward-finite-difference-method">
<h2>A2.1.3 First Order Forward Finite Difference Method<a class="headerlink" href="#a2-1-3-first-order-forward-finite-difference-method" title="Permalink to this headline">#</a></h2>
<p>We can approximate the slope at <span class="math notranslate nohighlight">\(x_0\)</span> by using a point in front of it, say <span class="math notranslate nohighlight">\(x\)</span></p>
<p>This form of approximation for the instantaneous slope we is known
as the <strong>first order derivative forward finite difference method</strong>. It is forward since we are applying knowledge
of our data point <span class="math notranslate nohighlight">\(x_0\)</span> to obtain information about a point <span class="math notranslate nohighlight">\(x\)</span> laying ahead (or forward) of
<span class="math notranslate nohighlight">\(x_0\)</span> by an amount <span class="math notranslate nohighlight">\(\Delta x\)</span>.</p>
<p>When we apply this method to update the value <span class="math notranslate nohighlight">\(f(x_o + \Delta x)\)</span> based on the known
value <span class="math notranslate nohighlight">\(f(x_0)\)</span>, it is often more convenient to write it in subscript form (this
notation is also more intuitive with respect to implementing it into a
computer script):</p>
<div class="math notranslate nohighlight">
\[ \frac{f(x_0 + \Delta x) - f(x_0)}{\Delta x} \sim A |_{x = x_0} \]</div>
<div class="math notranslate nohighlight">
\[ \frac{f(x_{i+1}) - f(x_i)}{x_{i+1}- x_i} \sim A |_{x = x_i} \]</div>
<div class="alert alert-success">
<div class="math notranslate nohighlight">
\[ \frac{f_{i+1} - f_i}{x_{i+1}- x_i} \sim A |_{x = x_i} \tag{2} \]</div>
</div>
<p>Equation (2) is the form we will implement as our numerical tool. While it would be great if you understand all the steps above, it is certainly not a requirement in this course. The applications are the essential and we will see some examples now.</p>
<hr style="height:2px;border-width:0;color:gray;background-color:gray"><div style="background-color: #D0D0D0 ; padding: 10px; border: 1px solid black;">       
<header>
<h3> Example 1</h3>
    </header>
<p>We will consider a simple equation that we can solve analytical
as well to demonstrate the use of the forward finite difference method.
Consider the following instantaneous slope equation with the condition that <span class="math notranslate nohighlight">\((y_0, x_0)
= (0,0)\)</span>:</p>
<div class="math notranslate nohighlight">
\[ A = x^2 \]</div>
<p><strong>Question</strong>: Find the solution <span class="math notranslate nohighlight">\(y(x)\)</span> at <span class="math notranslate nohighlight">\(x = 5\)</span>.</p>
<p>The actual solution is</p>
<div class="math notranslate nohighlight">
\[ y(x) = \frac{x^3}{3} \]</div>
<p>If we evaluate at <span class="math notranslate nohighlight">\(x = 5\)</span> we get:</p>
<img src="A2-fig2.png" width="300">
<p>Now let us try and solve it through numerical integration!</p>
<p>According to Equation (3), we can approximate the slope by</p>
<div class="math notranslate nohighlight">
\[ A |_{x = x_i} \sim \frac{f_{i+1} - f_i}{x_{i+1}- x_i} \]</div>
<p>In our case, the dependent variable is <span class="math notranslate nohighlight">\(y\)</span> and not <span class="math notranslate nohighlight">\(f\)</span>:</p>
<div class="math notranslate nohighlight">
\[ A |_{x = x_i} \sim \frac{y_{i+1} - y_i}{x_{i+1}- x_i} \]</div>
<p>In the numerical approach, we will start at our initial data point <span class="math notranslate nohighlight">\((y_0, x_0)
= (0,0)\)</span> and progress towards <span class="math notranslate nohighlight">\(x = 5\)</span> in chosen steps of <span class="math notranslate nohighlight">\(\Delta x = x_{i+1} - x_i\)</span>. We call <span class="math notranslate nohighlight">\(\Delta x\)</span> the <strong>step size</strong> and the process is called an <strong>iterative process</strong>.</p>
<p>Note: in a computational physics
course, we would learn more about how to make a proper choice regarding
this step size to obtain the most accurate solution without jeopardizing computer speed, but it is beyond the scope of this course.</p>
<p>The next step is to replace the instantaneous slope in our equation with the approximation:</p>
<div class="math notranslate nohighlight">
\[ \frac{y_{i+1} - y_i}{x_{i+1}- x_i} =  x_{i}^2\]</div>
<p><strong>Important: the variable <span class="math notranslate nohighlight">\(x\)</span> on the right side of the equation now got a subscript “i” attached to it. The reason is that we assume knowledge of <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> at our initial point. We must have this initial point to start the iteration</strong>!</p>
<p>We have now converted an instantaneous equation (continuous) into discrete (difference) equation that can be solved by arithmetic. Solving for our next <span class="math notranslate nohighlight">\(y\)</span> value:</p>
<div class="alert alert-success">
<div class="math notranslate nohighlight">
\[ y_{i+1} = y_i +  x_{i}^{2}\Delta x\]</div>
</div>
<p>We call this our <strong>iterative equation</strong> and is the equation we will use to step forward in <span class="math notranslate nohighlight">\(x\)</span> until we reach <span class="math notranslate nohighlight">\(x = 5\)</span>.
Let’s try and iterate it in the interval <span class="math notranslate nohighlight">\(x = [0,5]\)</span> in step sizes of 1:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>x</p></th>
<th class="head"><p></p></th>
<th class="head"><p>y</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(x_0 = 0\)</span></p></td>
<td><p>,</p></td>
<td><p><span class="math notranslate nohighlight">\(y_0 = 0\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(x_1 = 1\)</span></p></td>
<td><p>,</p></td>
<td><p><span class="math notranslate nohighlight">\(y_1 = y_0 + x_{0}^2\Delta t = 0 + (0)^2(1) = 0 \)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(x_2 = 2\)</span></p></td>
<td><p>,</p></td>
<td><p><span class="math notranslate nohighlight">\(y_2 = y_1 + x_{1}^2\Delta t = 0 + (1)^2(1) = 1 \)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(x_3 = 3\)</span></p></td>
<td><p>,</p></td>
<td><p><span class="math notranslate nohighlight">\(y_3 = y_2 + x_{2}^2\Delta t = 1 + (2)^2(1) = 5 \)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(x_4 = 4\)</span></p></td>
<td><p>,</p></td>
<td><p><span class="math notranslate nohighlight">\(y_4 = y_3 + x_{3}^2\Delta t = 5 + (3)^2(1) = 14 \)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(x_5 = 5\)</span></p></td>
<td><p>,</p></td>
<td><p><span class="math notranslate nohighlight">\(y_5 = y_4 + x_{4}^2\Delta t = 14 + (4)^2(1) = 30 \)</span></p></td>
</tr>
</tbody>
</table>
<div class="alert alert-success">
<p>Our numerical solution is <span class="math notranslate nohighlight">\(y = 30\)</span> at <span class="math notranslate nohighlight">\(x = 5\)</span>
</div></p>
<p>A quick comparison between the analytical solution (42) and the numerical (30) will tell us that we are quite
a bit off. However, we used a large step
size (<span class="math notranslate nohighlight">\(\Delta x = 1\)</span>), and the function is changing
significantly over this large step size. <strong>We
should choice a step size over which the function is not varying significantly</strong>. Let us try and repeat the process with a stepsize of <span class="math notranslate nohighlight">\(\Delta x = 0.1\)</span>:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>x</p></th>
<th class="head"><p></p></th>
<th class="head"><p>y</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(x_0 = 0\)</span></p></td>
<td><p>,</p></td>
<td><p><span class="math notranslate nohighlight">\(y_0 = 0\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(x_1 = 0.1\)</span></p></td>
<td><p>,</p></td>
<td><p><span class="math notranslate nohighlight">\(y_1 = y_0 + x_{0}^2\Delta t = 0 + (0)^2(1) = 0 \)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(x_2 = 0.2\)</span></p></td>
<td><p>,</p></td>
<td><p><span class="math notranslate nohighlight">\(y_2 = y_1 + x_{1}^2\Delta t = 0 + (0.1)^2(1) = 0.01 \)</span></p></td>
</tr>
</tbody>
</table>
<p>Hold on! I will have to do this about 50 times. No way, dude! Python to the rescue:</p>
</div><div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">y</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">dx</span> <span class="o">=</span> <span class="mf">0.1</span>

<span class="n">x_f</span> <span class="o">=</span> <span class="mf">5.</span>
<span class="n">nSteps</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">x_f</span><span class="o">/</span><span class="n">dx</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nSteps</span><span class="p">):</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">dx</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">dx</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Numerical Solution: &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Numerical Solution: 40.42500000000002
</pre></div>
</div>
</div>
</div>
<div style="background-color: #D0D0D0 ; padding: 10px; border: 1px solid black;">       
<p>That is pretty close. In fact, the percent error is:</p>
<div class="math notranslate nohighlight">
\[\textrm{percent error} = \frac{|\textrm{Numerical} - \textrm{Analytic}|}{\textrm{Analytic}}\times 100\% = \frac{40.425 - 40}{40}*100\% = 1\%\]</div>
<p>Let us visualize the analytic and numerical solutions:</p>
</div><div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="c1"># Analytic solution</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">5.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">t</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="mf">3.</span>

<span class="c1"># Numerical solution</span>

<span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">dx</span> <span class="o">=</span> <span class="mf">0.1</span>

<span class="n">x_f</span> <span class="o">=</span> <span class="mf">5.</span>
<span class="n">nSteps</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">x_f</span><span class="o">/</span><span class="n">dx</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nSteps</span><span class="p">):</span>
    <span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">dx</span><span class="p">)</span>
    <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">dx</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Numerical Solution: &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">nSteps</span><span class="p">]))</span>

<span class="c1"># Plotting</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y(x)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x</span><span class="p">)])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">y</span><span class="p">)])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Numerical Solution: 40.42500000000002
</pre></div>
</div>
<img alt="../_images/53fe5bef86c791d3056d291dba66f913c511d6d663d19e34655ef3d4a52e86c5.png" src="../_images/53fe5bef86c791d3056d291dba66f913c511d6d663d19e34655ef3d4a52e86c5.png" />
</div>
</div>
<div style="background-color: #D0D0D0 ; padding: 10px; border: 1px solid black;">       
<p>Here we can see how good our numerical solution (blue) is compared to the actual solution (red). Isn’t this amazing? We can apply this approach to a variety of complex physics problems, that we otherwise could not cover in Physics I.</p>
</div>
<hr style="height:2px;border-width:0;color:gray;background-color:gray"><div class="alert alert-warning">
<b>Box 1</b><br>
<p>Consider the instantaneous slope equation</p>
<div class="math notranslate nohighlight">
\[ A = x^3 \]</div>
<p>Using numerical approach, find the solution <span class="math notranslate nohighlight">\(y(x)\)</span> at <span class="math notranslate nohighlight">\(x = 5\)</span> if we know that <span class="math notranslate nohighlight">\((x_0, y_0) = (0,2)\)</span>. The analytic solution is</p>
<div class="math notranslate nohighlight">
\[ y = \frac{1}{4}x^4 + 2 \]</div>
<p>What is the percent error between the analytical and numerical solutions? Create a plot showing the analytical and numerical solution.</p>
</div>
<hr style="height:2px;border-width:0;color:gray;background-color:gray"></section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Module-A2"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="../Module-A1/problemsA1.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">A1.x Problems</p>
      </div>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a2-1-1-motivation">A2.1.1 Motivation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a2-1-2-linearization">A2.1.2 Linearization</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a2-1-3-first-order-forward-finite-difference-method">A2.1.3 First Order Forward Finite Difference Method</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Kim Nielsen
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>